<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Meeting Notes Generator | Summarize Meetings & Audio Online</title>
    <meta name="description" content="Convert meeting recordings into clean, structured summaries instantly. Upload or record audio, and get AI-powered notes with download & copy options in seconds.">
    <meta name="keywords" content="AI meeting notes generator, summarize meeting audio online, meeting transcription tool, AI audio summarizer, meeting minutes generator, record and summarize meetings">
    <meta name="robots" content="index, follow">
</head>
<body class="m-0 min-h-screen bg-gradient-to-b from-indigo-50 to-white flex justify-center items-start p-4 sm:p-10 font-sans">

<div class="w-full max-w-3xl bg-white rounded-2xl shadow-2xl p-6 sm:p-8">

    <h1 class="text-3xl sm:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600">
        AI Meeting Notes Generator
    </h1>
    <p class="text-slate-600 mt-2">Convert conversations into professional summaries — instantly.</p>


    <!-- Website Description -->
    <div class="bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-100 rounded-xl p-6 sm:p-8 mb-6 shadow-inner">
        <h2 class="text-xl sm:text-2xl font-semibold text-indigo-700 mb-3">✨ Save Hours on Note-Taking</h2>
        <p class="text-slate-600 leading-relaxed">
            Tired of manually writing meeting notes? Our <span class="font-medium text-indigo-600">AI-powered generator</span>
            instantly transforms your <span class="font-medium">meeting recordings</span> or <span class="font-medium">audio links</span>
            into clean, structured summaries.
        </p>
        <ul class="mt-4 space-y-2 text-slate-700">
            <li class="flex items-start gap-2">
                <span class="text-indigo-500">✔</span>
                Upload audio files or paste links (MP3, WAV, M4A, MP4).
            </li>
            <li class="flex items-start gap-2">
                <span class="text-indigo-500">✔</span>
                Record live conversations directly from the browser.
            </li>
            <li class="flex items-start gap-2">
                <span class="text-indigo-500">✔</span>
                Get instant AI summaries you can <span class="font-medium">download as PDF</span> or <span class="font-medium">copy with one click</span>.
            </li>
        </ul>
        <p class="mt-4 text-slate-500 text-sm">
            Perfect for <span class="font-medium text-indigo-600">teams, students, and professionals</span> who never want to miss a key detail again.
        </p>
    </div>


    <!-- Upload Form -->
    <form id="uploadForm" enctype="multipart/form-data" method="post" class="space-y-5">
        <div id="drop" class="border-2 border-dashed border-slate-300 rounded-xl bg-slate-50 p-6 text-center transition hover:border-indigo-500 hover:bg-indigo-50">
            <p class="text-slate-600">Drag & drop your audio here</p>

            <div class="flex flex-col sm:flex-row items-center justify-center gap-3 mt-3">
                <label for="file" class="cursor-pointer bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-5 py-2.5 rounded-lg">
                    Choose File
                </label>
                <span id="fileName" class="text-sm text-slate-600 truncate max-w-[200px] sm:max-w-[250px]"></span>

                <input id="file" type="file" name="file" accept="audio/*" required class="hidden" onchange="toggleRemoveBtn()"/>

                <button type="button" class="rm-btn hidden" onclick="clearFileInput()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-5 h-5 fill-current">
                        <path fill="#d41616" d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM231 231C240.4 221.6 255.6 221.6 264.9 231L319.9 286L374.9 231C384.3 221.6 399.5 221.6 408.8 231C418.1 240.4 418.2 255.6 408.8 264.9L353.8 319.9L408.8 374.9C418.2 384.3 418.2 399.5 408.8 408.8C399.4 418.1 384.2 418.2 374.9 408.8L319.9 353.8L264.9 408.8C255.5 418.2 240.3 418.2 231 408.8C221.7 399.4 221.6 384.2 231 374.9L286 319.9L231 264.9C221.6 255.5 221.6 240.3 231 231z"/>
                    </svg>
                </button>
            </div>


            <!-- OR Divider
            <div class="flex items-center my-4">
                <div class="flex-grow border-t border-slate-300"></div>
                <span class="px-2 text-sm text-slate-500">OR</span>
                <div class="flex-grow border-t border-slate-300"></div>
            </div>

             Audio Link Bar
            <div class="flex flex-col sm:flex-row gap-3 items-center">
                <label for="audioLink"></label><input
                        type="url"
                        id="audioLink"
                        name="audioLink"
                        placeholder="Paste audio file link (MP3, WAV, M4A)"
                        class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                >
                <button type="button" class="p-2 rounded-lg bg-red-500 hover:bg-red-600 text-white" onclick="clearAudioLink()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-5 h-5 fill-current">
                        <path fill="#d41616" d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM231 231C240.4 221.6 255.6 221.6 264.9 231L319.9 286L374.9 231C384.3 221.6 399.5 221.6 408.8 231C418.1 240.4 418.2 255.6 408.8 264.9L353.8 319.9L408.8 374.9C418.2 384.3 418.2 399.5 408.8 408.8C399.4 418.1 384.2 418.2 374.9 408.8L319.9 353.8L264.9 408.8C255.5 418.2 240.3 418.2 231 408.8C221.7 399.4 221.6 384.2 231 374.9L286 319.9L231 264.9C221.6 255.5 221.6 240.3 231 231z"/>
                    </svg>
                </button>
            </div>
            -->

            <!-- Progress -->
            <div class="w-full h-2 bg-slate-200 rounded-full overflow-hidden mt-4 hidden" id="progress">
                <div id="bar" class="h-full bg-indigo-600 w-0 transition-all duration-300"></div>
            </div>

            <p class="text-xs text-slate-500 mt-2">Supported: MP3, WAV, M4A, MP4 • Max 25MB</p>
        </div>

        <div class="flex flex-col sm:flex-row gap-3 mt-4">
            <button type="button" id="recordBtn" class="w-full sm:w-auto px-5 py-2.5 rounded-lg font-semibold text-white bg-amber-500 hover:bg-amber-600">
                <svg class="w-5 h-5 mr-2 inline" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640">
                    <path d="M320 64C267 64 224 107 224 160L224 288C224 341 267 384 320 384C373 384 416 341 416 288L416 160C416 107 373 64 320 64zM176 248C176 234.7 165.3 224 152 224C138.7 224 128 234.7 128 248L128 288C128 385.9 201.3 466.7 296 478.5L296 528L248 528C234.7 528 224 538.7 224 552C224 565.3 234.7 576 248 576L392 576C405.3 576 416 565.3 416 552C416 538.7 405.3 528 392 528L344 528L344 478.5C438.7 466.7 512 385.9 512 288L512 248C512 234.7 501.3 224 488 224C474.7 224 464 234.7 464 248L464 288C464 367.5 399.5 432 320 432C240.5 432 176 367.5 176 288L176 248z"/>
                </svg>
                Record
            </button>
            <button type="submit" class="w-full sm:w-auto px-5 py-2.5 rounded-lg font-semibold text-white bg-emerald-600 hover:bg-emerald-700">Summarize</button>
        </div>
    </form>

    <!-- Summary -->
    <div id="summary-wrap" class="mt-5"></div>
    <!-- PDF + Copy -->
    <form id="pdfForm" method="POST" action="/download-pdf">
        <input type="hidden" name="summary" id="summaryInput" />
        <div class="flex flex-col sm:flex-row gap-3 mt-4">
            <button type="button" id="downloadBtn" class="hidden px-5 py-2.5 rounded-lg font-semibold text-white bg-indigo-600 hover:bg-indigo-700">Download as PDF</button>
            <button type="button" id="copyBtn" class="hidden px-5 py-2.5 rounded-lg font-semibold bg-slate-200 hover:bg-slate-300">Copy Text</button>
        </div>
    </form>

    <p class="mt-6 text-xs text-slate-500 text-center">Powered by AI • Your files are processed on-the-fly and not stored.</p>
</div>

<script>
    const drop = document.getElementById('drop');
    const fileInput = document.getElementById('file');
    const uploadForm = document.getElementById('uploadForm');
    const summaryContainer = document.getElementById('summary-wrap'); // ✅ consistent naming
    const bar = document.getElementById('bar');
    const progress = document.getElementById('progress');
    const downloadBtn = document.getElementById('downloadBtn');
    const copyBtn = document.getElementById('copyBtn');
    const summaryInput = document.getElementById('summaryInput');
    const fileNameSpan = document.getElementById('fileName');
    const recordBtn = document.getElementById('recordBtn');
    const audioLinkInput = document.getElementById('audioLink');

    let mediaRecorder, recordedChunks = [], currentStream = null;

    // Hide copy/download initially
    downloadBtn.style.display = 'none';
    copyBtn.style.display = 'none';

    // Show file name after selecting
    fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {
            fileNameSpan.textContent = fileInput.files[0].name;
        } else {
            fileNameSpan.textContent = '';
        }
    });

    function clearAudioLink() {
        document.getElementById("audioLink").value = "";
    }

    function toggleRemoveBtn() {
        const fileInput = document.getElementById("file");
        const removeBtn = document.querySelector(".rm-btn");
        const fileName = document.getElementById("fileName");

        if (fileInput.files.length > 0) {
            fileName.textContent = fileInput.files[0].name;
            removeBtn.classList.remove("hidden");
        } else {
            fileName.textContent = "";
            removeBtn.classList.add("hidden");
        }
    }

    function clearFileInput() {
        const fileInput = document.getElementById("file");
        const removeBtn = document.querySelector(".rm-btn");
        const fileName = document.getElementById("fileName");

        fileInput.value = "";
        fileName.textContent = "";
        removeBtn.classList.add("hidden");
    }


    // Helper to toggle button content
    function toggleRecordButton(isRecording) {
        if (isRecording) {
            // Stop icon
            recordBtn.innerHTML = `
            <svg class="w-5 h-5 mr-2 inline" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640">
                <path d="M160 96L480 96C515.3 96 544 124.7 544 160L544 480C544 515.3 515.3 544 480 544L160 544C124.7 544 96 515.3 96 480L96 160C96 124.7 124.7 96 160 96z"/>
            </svg>
            Stop
        `;
        } else {
            // Mic icon
            recordBtn.innerHTML = `
            <svg class="w-5 h-5 mr-2 inline" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 640 640">
                <path d="M320 64C267 64 224 107 224 160L224 288C224 341 267 384 320 384C373 384 416 341 416 288L416 160C416 107 373 64 320 64zM176 248C176 234.7 165.3 224 152 224C138.7 224 128 234.7 128 248L128 288C128 385.9 201.3 466.7 296 478.5L296 528L248 528C234.7 528 224 538.7 224 552C224 565.3 234.7 576 248 576L392 576C405.3 576 416 565.3 416 552C416 538.7 405.3 528 392 528L344 528L344 478.5C438.7 466.7 512 385.9 512 288L512 248C512 234.7 501.3 224 488 224C474.7 224 464 234.7 464 248L464 288C464 367.5 399.5 432 320 432C240.5 432 176 367.5 176 288L176 248z"/>
            </svg>
            Record
        `;
        }
    }

    // Recording feature with flashing red effect
    let flashInterval = null;

    // Recording feature
    recordBtn.onclick = async () => {
        if (!mediaRecorder || mediaRecorder.state === "inactive") {
            try {
                currentStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                recordedChunks = [];
                mediaRecorder = new MediaRecorder(currentStream);
                mediaRecorder.ondataavailable = e => {
                    if (e.data.size > 0) recordedChunks.push(e.data);
                };
                mediaRecorder.onstop = () => {
                    const blob = new Blob(recordedChunks, { type: 'audio/webm' });
                    const file = new File([blob], "recording.webm", { type: 'audio/webm' });
                    const dt = new DataTransfer();
                    dt.items.add(file);
                    fileInput.files = dt.files;
                    fileNameSpan.textContent = file.name;

                    // Stop mic stream
                    if (currentStream) {
                        currentStream.getTracks().forEach(track => track.stop());
                        currentStream = null;
                    }
                    // Stop flashing
                    clearInterval(flashInterval);
                    recordBtn.style.background = "#f59e0b";
                    toggleRecordButton(false);
                };
                mediaRecorder.start();
                toggleRecordButton(true);

                // Flashing red background while recording
                flashInterval = setInterval(() => {
                    recordBtn.style.background =
                        recordBtn.style.background === "red" ? "#dc2626" : "red";
                }, 500);

            } catch (err) {
                alert("Microphone access denied or unavailable.");
            }
        } else {
            mediaRecorder.stop();
            recordBtn.textContent = "🎙 Record";
            recordBtn.style.background = "#f59e0b";
        }
    };

    function updateFileName() {
        if (fileInput.files.length > 0) {
            fileNameSpan.textContent = fileInput.files[0].name;
        } else {
            fileNameSpan.textContent = '';
        }
    }

    fileInput.addEventListener('change', updateFileName);

    ['dragenter','dragover'].forEach(evt => drop.addEventListener(evt, e => {
        e.preventDefault();
        e.stopPropagation();
        drop.classList.add('drag');
    }));
    ['dragleave','drop'].forEach(evt => drop.addEventListener(evt, e => {
        e.preventDefault();
        e.stopPropagation();
        drop.classList.remove('drag');
    }));
    drop.addEventListener('drop', e => {
        if (e.dataTransfer.files && e.dataTransfer.files[0]) {
            fileInput.files = e.dataTransfer.files;
            updateFileName();
        }
    });


    // Upload with progress
    uploadForm.addEventListener('submit', e => { // ✅ changed 'form' to 'uploadForm'
        e.preventDefault();
        const file = fileInput.files[0];
        if (!file) return alert('Please choose a file.');
        const audioLink = audioLinkInput.value.trim(); // ✅ new
        if (file.size > 25 * 1024 * 1024) { alert('File too large (max 25MB).'); return; }

        if (!file && !audioLink) {
            return alert('Please choose a file or paste an audio link.');
        }

        const data = new FormData();
        if (file) {
            data.append('file', file);
        } else {
            data.append('audioLink', audioLink); // ✅ send link if no file
        }

        progress.style.display = 'block';
        bar.style.width = '10%';
        summaryContainer.innerHTML = "<div class='summary-card'>Generating summary...</div>"; // ✅ fixed var name
        downloadBtn.style.display = 'none';
        copyBtn.style.display = 'none';

        const xhr = new XMLHttpRequest();
        xhr.open('POST', '/upload', true);

        xhr.upload.onprogress = (e) => {
            if (e.lengthComputable) {
                const pct = Math.max(10, Math.min(90, Math.round((e.loaded / e.total) * 100)));
                bar.style.width = pct + '%';
            }
        };

        xhr.onload = () => {
            bar.style.width = '100%';
            setTimeout(() => { progress.style.display = 'none'; bar.style.width = '0%'; }, 400);

            if (xhr.status >= 200 && xhr.status < 300) {
                // ✅ Ensure only summary text is displayed
                summaryContainer.innerHTML = `<div class="summary-card">${xhr.responseText}</div>`;

                summaryInput.value = summaryContainer.innerText;

                downloadBtn.style.display = 'inline-block';
                copyBtn.style.display = 'inline-block';

            } else {
                summaryContainer.innerHTML = "<div class='error'>Upload failed. Try again.</div>";
            }
        };

        xhr.onerror = () => {
            progress.style.display = 'none';
            summaryContainer.innerHTML = "<div class='error'>Network error. Please check your connection.</div>";
        };

        xhr.send(data);
    });

    downloadBtn.onclick = () => {
        if (!summaryInput.value.trim()) {
            alert('No summary yet.');
            return;
        }
        document.getElementById('pdfForm').submit();
    };

    copyBtn.onclick = async () => {
        const text = summaryInput.value || summaryContainer.innerText || '';
        if (!text.trim()) return;
        try {
            await navigator.clipboard.writeText(text);
            copyBtn.textContent = 'Copied!';
            setTimeout(() => copyBtn.textContent = 'Copy Text', 1200);
        } catch {
            alert('Copy failed.');
        }
    };
</script>

</body>
</html>
